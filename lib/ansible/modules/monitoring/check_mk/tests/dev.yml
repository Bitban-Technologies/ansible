---
- name: test my new module
  connection: local
  hosts: localhost
  tasks:

  - name: check mk
    check_mk:
      server: 192.168.56.60
      omdsite: ndevel
      action: add_host
      username: ansible
      password: ATTEBFHVDKLYALQUGVCV
      hostname: centos6
      folder: servers
    register: addhost

  - name: debug
    debug:
      var: addhost

  - name: check mk
    check_mk:
      server: 192.168.56.60
      omdsite: ndevel
      action: discover_services
      username: ansible
      password: ATTEBFHVDKLYALQUGVCV
      hostname: centos6
      discover_services_mode: refresh
    register: addhost

  - name: debug
    debug:
      var: addhost

  - name: check mk
    check_mk:
      server: 192.168.56.60
      omdsite: ndevel
      action: activate_changes
      username: ansible
      password: ATTEBFHVDKLYALQUGVCV
    register: addhost

  - name: debug
    debug:
      var: addhost
